<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#000000">
  <title>ICAZET Countdown</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      height: 100vh;
      height: -webkit-fill-available;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      align-items: center;
      background: #000;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', sans-serif;
      overflow: hidden;
      padding-bottom: 8vh;
      touch-action: manipulation;
    }

    /* Video-Hintergrund mit Fallback */
    #bgVideo {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      min-width: 100%;
      min-height: 100%;
      z-index: -1;
      opacity: 0.8;
      object-fit: cover;
    }

    .video-fallback {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      z-index: -2;
    }

    /* Countdown-Container */
    .flip-clock {
      display: flex;
      gap: 1.5vw;
      justify-content: center;
      flex-wrap: wrap;
      width: 90%;
      max-width: 800px;
    }

    /* Digit-Container */
    .digit-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0 0.5vw;
    }

    .digit-container {
      position: relative;
      width: 22vw;
      width: clamp(70px, 22vw, 120px);
      height: 24vw;
      height: clamp(80px, 24vw, 130px);
      max-width: 120px;
      max-height: 130px;
      min-width: 70px;
      min-height: 80px;
      perspective: 1000px;
      -webkit-perspective: 1000px;
    }

    /* Aktuelle Zahl */
    .current-digit {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 10vw;
      font-size: clamp(40px, 10vw, 80px);
      font-weight: bold;
      color: white;
      background: rgba(30, 30, 30, 0.9);
      border-radius: 2vw;
      box-shadow: 0 1vw 2vw rgba(0, 0, 0, 0.5);
      position: relative;
      z-index: 1;
      user-select: none;
    }

    /* Beschriftung */
    .digit-label {
      color: rgba(255, 255, 255, 0.7);
      font-size: 3vw;
      font-size: clamp(12px, 3vw, 20px);
      margin-top: 1.5vw;
      text-transform: uppercase;
      letter-spacing: 1px;
      user-select: none;
    }

    /* Animation */
    .flip-card {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transform-origin: center;
      z-index: 2;
      -webkit-transform-style: preserve-3d;
      -webkit-transform-origin: center;
    }

    .flip-animation {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 10vw;
      font-size: clamp(40px, 10vw, 80px);
      font-weight: bold;
      color: white;
      background: rgba(40, 40, 40, 0.9);
      border-radius: 2vw;
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
      transform: rotateX(0deg);
      box-shadow: 0 1vw 2vw rgba(0, 0, 0, 0.5);
    }

    .flip-animation.flip {
      animation: cleanFlip 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
      -webkit-animation: cleanFlip 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }

    @keyframes cleanFlip {
      0% { transform: rotateX(0deg); }
      100% { transform: rotateX(-180deg); }
    }

    @-webkit-keyframes cleanFlip {
      0% { -webkit-transform: rotateX(0deg); }
      100% { -webkit-transform: rotateX(-180deg); }
    }

    /* Text-Anzeige */
    .text-display {
      text-align: center;
      width: 90%;
      max-width: 600px;
      color: white;
      font-size: clamp(1rem, 4vw, 1.5rem);
      padding: clamp(10px, 3vw, 20px);
      background: rgba(0, 0, 0, 0.7);
      border-radius: 2vw;
      margin-top: 5vw;
      opacity: 1;
      transition: opacity 1s ease;
      user-select: none;
    }

    /* Countdown finished styles */
    .countdown-finished {
      font-size: clamp(1.5rem, 6vw, 2.5rem);
      font-weight: bold;
      color: #fff;
      text-align: center;
      margin-top: 20px;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
      display: none;
    }

    /* Kompatibilitätswarnung */
    .compatibility-warning {
      color: white;
      background: rgba(255, 0, 0, 0.7);
      padding: 15px;
      border-radius: 5px;
      text-align: center;
      margin: 20px;
      display: none;
    }

    /* Touch-Optimierungen */
    @media (pointer: coarse) {
      .digit-container {
        width: 25vw;
        height: 27vw;
      }
      .digit-label {
        font-size: 4vw;
      }
    }

    /* Portrait-Modus Anpassungen */
    @media (orientation: portrait) and (max-height: 600px) {
      .digit-container {
        width: 18vw;
        height: 20vw;
      }
      .current-digit, .flip-animation {
        font-size: 8vw;
      }
      .digit-label {
        font-size: 2.5vw;
      }
    }

    /* Landscape-Modus Anpassungen */
    @media (orientation: landscape) {
      .digit-container {
        width: 15vh;
        height: 16vh;
      }
      .current-digit, .flip-animation {
        font-size: 8vh;
      }
      .digit-label {
        font-size: 2.5vh;
      }
      .text-display {
        font-size: clamp(1rem, 3vh, 1.5rem);
      }
    }

    /* Safari-spezifische Anpassungen */
    @supports (-webkit-touch-callout: none) {
      body {
        height: -webkit-fill-available;
      }
      .digit-container {
        height: 20vh;
      }
    }
  </style>
</head>
<body>
  <!-- Video-Hintergrund mit Fallback -->
  <video autoplay muted loop playsinline id="bgVideo" poster="fallback.jpg">
    <source src="ay.mp4" type="video/mp4">
    <source src="ay.webm" type="video/webm">
    Your browser does not support HTML5 video.
  </video>
  <div class="video-fallback"></div>

  <!-- Kompatibilitätswarnung -->
  <div class="compatibility-warning" id="compatibility-warning">
    Ihr Gerät unterstützt nicht alle Funktionen dieses Countdowns
  </div>

  <!-- Countdown mit Beschriftungen -->
  <div class="flip-clock" id="countdown-container">
    <div class="digit-group">
      <div class="digit-container" id="days-container">
        <div class="current-digit" id="days-display">00</div>
      </div>
      <div class="digit-label">gün</div>
    </div>
    
    <div class="digit-group">
      <div class="digit-container" id="hours-container">
        <div class="current-digit" id="hours-display">00</div>
      </div>
      <div class="digit-label">saat</div>
    </div>
    
    <div class="digit-group">
      <div class="digit-container" id="minutes-container">
        <div class="current-digit" id="minutes-display">00</div>
      </div>
      <div class="digit-label">dakika</div>
    </div>
    
    <div class="digit-group">
      <div class="digit-container" id="seconds-container">
        <div class="current-digit" id="seconds-display">00</div>
      </div>
      <div class="digit-label">saniye</div>
    </div>
  </div>

  <!-- Text-Anzeige -->
  <div class="text-display" id="text-element">
    Geri sayım başladı!
  </div>

  <!-- Countdown finished message -->
  <div class="countdown-finished" id="finished-message">
    Zaman geldi! Beklenen an şimdi!
  </div>

  <!-- Sound -->
  <audio id="flipSound" src="https://assets.mixkit.co/sfx/preview/mixkit-clock-countdown-bleeps-916.mp3" preload="auto"></audio>

  <script>
    // Warten bis DOM vollständig geladen
    document.addEventListener('DOMContentLoaded', function() {
      // Feature Detection
      if (!('requestAnimationFrame' in window) || !('flexWrap' in document.documentElement.style)) {
        document.getElementById('compatibility-warning').style.display = 'block';
      }
      
      // Audio-Kontext für mobile Geräte aktivieren
      function activateAudio() {
        const audio = document.getElementById('flipSound');
        audio.volume = 0.5;
        try {
          audio.play().then(() => {
            audio.pause();
            audio.currentTime = 0;
          }).catch(e => console.log("Audio-Vorschau fehlgeschlagen:", e));
        } catch (e) {
          console.log("Audio-Fehler:", e);
        }
        document.body.removeEventListener('click', activateAudio);
      }
      
      document.body.addEventListener('click', activateAudio);
      
      // Countdown-Logik
      const targetDate = new Date("2025-06-19T10:00:00").getTime();
      const flipSound = document.getElementById('flipSound');
      const textElement = document.getElementById('text-element');
      const countdownContainer = document.getElementById('countdown-container');
      const finishedMessage = document.getElementById('finished-message');
      
      // Texte
      const texts = [
        "Geri sayım başladı!",
        "Beklediğimiz gün geliyor!",
        "Tarihe geçecek bir an için hazır ol.",
        "Hazırlan, büyük an kapıda!",
        "Göz açıp kapayıncaya kadar burada olacağız!",
        "Zaman geçer, anlar kalır.",
        "Sessizlikten önceki en derin nefes: bu an."
      ];
      
      let currentValues = { days: 0, hours: 0, minutes: 0, seconds: 0 };
      let lastValues = { days: -1, hours: -1, minutes: -1, seconds: -1 };
      let currentTextIndex = 0;
      let countdownActive = true;

      // Hauptfunktionen
      function updateCountdown() {
        const now = window.performance && window.performance.now ? 
          performance.timing.navigationStart + performance.now() : 
          new Date().getTime();
        const distance = targetDate - now;

        // Check if countdown has finished
        if (distance < 0) {
          if (countdownActive) {
            countdownFinished();
          }
          return;
        }

        currentValues = {
          days: Math.floor(distance / (1000 * 60 * 60 * 24)),
          hours: Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)),
          minutes: Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)),
          seconds: Math.floor((distance % (1000 * 60)) / 1000)
        };

        updateDisplays();
        checkAnimations();
        
        if (currentValues.seconds % 30 === 0 && lastValues.seconds !== currentValues.seconds) {
          rotateText();
        }
        
        lastValues = {...currentValues};
      }

      function countdownFinished() {
        countdownActive = false;
        countdownContainer.style.display = "none";
        textElement.style.display = "none";
        finishedMessage.style.display = "block";
      }

      function updateDisplays() {
        document.getElementById("days-display").textContent = formatTime(currentValues.days);
        document.getElementById("hours-display").textContent = formatTime(currentValues.hours);
        document.getElementById("minutes-display").textContent = formatTime(currentValues.minutes);
        document.getElementById("seconds-display").textContent = formatTime(currentValues.seconds);
      }

      function checkAnimations() {
        if (currentValues.days < lastValues.days) animateFlip("days");
        if (currentValues.hours < lastValues.hours) animateFlip("hours");
        if (currentValues.minutes < lastValues.minutes) animateFlip("minutes");
        if (currentValues.seconds < lastValues.seconds) animateFlip("seconds");
      }

      function animateFlip(unit) {
        const container = document.getElementById(`${unit}-container`);
        
        // Clear any existing animations
        const oldCards = container.querySelectorAll(".flip-card");
        oldCards.forEach(card => card.remove());
        
        // Create new animation
        const flipCard = document.createElement("div");
        flipCard.className = "flip-card";
        
        const flipElement = document.createElement("div");
        flipElement.className = "flip-animation flip";
        flipElement.textContent = formatTime(lastValues[unit]);
        
        flipCard.appendChild(flipElement);
        container.appendChild(flipCard);
        
        // Play sound
        try {
          flipSound.currentTime = 0;
          flipSound.play().catch(e => console.log("Audio konnte nicht abgespielt werden:", e));
        } catch (e) {
          console.log("Audio-Fehler:", e);
        }
        
        // Clean up after animation
        setTimeout(() => {
          flipCard.remove();
        }, 600);
      }

      function rotateText() {
        textElement.style.opacity = 0;
        setTimeout(() => {
          currentTextIndex = (currentTextIndex + 1) % texts.length;
          textElement.textContent = texts[currentTextIndex];
          textElement.style.opacity = 1;
        }, 1000);
      }

      function formatTime(time) {
        return time < 10 ? `0${time}` : time;
      }

      // Video fallback check
      const video = document.getElementById("bgVideo");
      video.addEventListener("error", () => {
        console.log("Video konnte nicht geladen werden, Fallback-Hintergrund wird verwendet");
        document.querySelector(".video-fallback").style.zIndex = "-1";
      });

      // Verhindert Zoomen auf Touch-Geräten
      document.addEventListener('touchmove', function(e) {
        if (e.scale !== 1) { e.preventDefault(); }
      }, { passive: false });

      // Touch-Feedback für Digit-Container
      document.querySelectorAll('.digit-container').forEach(el => {
        el.addEventListener('touchstart', function() {
          this.style.transform = 'scale(0.95)';
        });
        el.addEventListener('touchend', function() {
          this.style.transform = 'scale(1)';
        });
      });

      // Initialisierung
      updateCountdown();
      const countdownInterval = setInterval(updateCountdown, 1000);

      // Globaler Error-Handler
      window.addEventListener('error', function(e) {
        console.error('Countdown Fehler:', e);
        document.getElementById('text-element').textContent = 
          "Technische Schwierigkeiten - Der Countdown wird bald fortgesetzt";
        clearInterval(countdownInterval);
        
        // Einfachen Countdown als Fallback anzeigen
        setInterval(function() {
          const now = new Date().getTime();
          const distance = targetDate - now;
          document.getElementById('seconds-display').textContent = 
            Math.floor((distance % (1000 * 60)) / 1000);
        }, 1000);
      });
    });
  </script>
</body>
</html>